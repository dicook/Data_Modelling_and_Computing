<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>ETC1010: Data Modelling and Computing</title>
    <meta charset="utf-8" />
    <meta name="author" content="Dr. Nicholas Tierney &amp; Professor Di Cook" />
    <meta name="date" content="2019-08-30" />
    <link href="libs/remark-css/shinobi.css" rel="stylesheet" />
    <link href="libs/remark-css/ninjutsu.css" rel="stylesheet" />
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <link rel="stylesheet" href="slides.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# ETC1010: Data Modelling and Computing
## Lecture 5B: Web Scraping
### Dr. Nicholas Tierney &amp; Professor Di Cook
### EBS, Monash U.
### 2019-08-30

---







background-image: url(https://www.kdnuggets.com/images/cartoon-turkey-data-science.jpg)
background-size: contain
background-position: 50% 50%
class: left, white

.vvhuge[
While the song is playing...
]

.vhuge[
Draw a mental model / concept map of last lectures content on data visualisation.
]


---
class: bg-main1

# Overview

.huge[
- Assignment comments
- Exam / study advice
- Different file formats
    - Audio / binary
- Web data
    - responsible scraping
    - scraping
    - JSON
]

---

# Assignment notes

.huge[
- Some questions might seem a bit strange - this is normal! 
- Sometimes you can't answer the exact question with the data you have. - It might be frustrating, but **rest assured** that for the question about combining the crime data with income data, there is no "trick" - the data isn't perfect here. 
- Describe how you think the solution you have provided helps answer the question, show us a plot, and describe what sort of other information you might like to try and have, or what you think we can learn.
]

---
class: bg-main5

# Learning technique: study

--

.huge[
1. Practice previous exam in exam conditions
2. Think up exam questions, write them down
3. Practice explaining concepts - either out aloud by yourself, in the mirror, to a friend, to an empty room. Saying things out aloud builds better connections.
]

---
class: bg-main5

# Learning technique: in exam

--

.huge[
1. Peruse the exam before starting
2. Take off one shoe (If you like - my high school teacher claimed this worked, and I did it.)
3. Number questions in order from easy-hard - start with the easiest one first
4. Work out a marks : minutes ratio. (e.g., if there are 60 marks, and 60 minutes, then it's one mark per minute of time spent.)

]



---
class: bg-main1

# Recap on some tricky topics

.huge[
- assignment ("gets" - `&lt;-`)
- pipes (from the textbook)
]

---
class: bg-main1

# The pipe operator: `%&gt;%`

.pull-left.huge[
- Code to tell a story about a little bunny foo foo (borrowed from https://r4ds.had.co.nz/pipes.html):
- Using functions for each verb: `hop()`, `scoop()`, `bop()`.

]
.pull-right.huge[
&gt; Little bunny Foo Foo
Went hopping through the forest
Scooping up the field mice
And bopping them on the head
]

---
class: bg-main1

# Approach: Intermediate steps

.huge[
```r
foo_foo_1 &lt;- hop(foo_foo, through = forest)
foo_foo_2 &lt;- scoop(foo_foo_1, up = field_mice)
foo_foo_3 &lt;- bop(foo_foo_2, on = head)
```
]

--

.huge[
- Main downside: forces you to name each intermediate element. 
- Sometimes these steps form natural names. If this is the case - go ahead.
- **But many times there are not natural names**
- Adding number suffixes to make the names unique leads to problems. 
]

---
class: bg-main1

# Approach: Intermediate steps

.huge[
```r
foo_foo_1 &lt;- hop(foo_foo, through = forest)
foo_foo_2 &lt;- scoop(foo_foo_1, up = field_mice)
foo_foo_3 &lt;- bop(foo_foo_2, on = head)
```
]

--

.huge[

- Code is cluttered with unimportant names
- Suffix has to be carefully incremented on each line.
- I've done this. 99% of the time I mess a number somewhere and spend the rest
of the night debugging my code.
]

---
class: bg-main1

# Another Approach: Overwrite the original

.huge[
```r
foo_foo &lt;- hop(foo_foo, through = forest)
foo_foo &lt;- scoop(foo_foo, up = field_mice)
foo_foo &lt;- bop(foo_foo, on = head)
```
]

--

.huge[
- Overwrite originals instead of creating intermediate objects 
- Less typing (and less thinking). Less likely to make mistakes?
- **Painful debugging**: need to re-run the code from the top.
- Repitition of object - (`foo_foo` written 6 times!) Obscures what changes.
]


---
class: bg-main1

# (Yet) Another approach: function composition

.huge[
```r
bop(
  scoop(
    hop(foo_foo, through = forest),
    up = field_mice
  ), 
  on = head
)
```
]

--

.huge[
- You need to read inside-out, and right-to-left.
- Arguments are spread far apart
- Harder to read
]

---
class: bg-main1

# Pipe `%&gt;%` can help!

.huge.pull-left[
`f(x)` 

`g(f(x))`

`h(g(f(x)))`
]

--

.vlarge.pull-right[
`x %&gt;% f()`

`x %&gt;% f() %&gt;% g()`

`x %&gt;% f() %&gt;% g() %&gt;% h()`
]

---
class: bg-main1

# Solution: Use the pipe - `%&gt;%`

.huge[

```r
foo_foo %&gt;%
  hop(through = forest) %&gt;%
  scoop(up = field_mice) %&gt;%
  bop(on = head)
```

]

.huge[

- focusses on verbs, not nouns. 
- Can be read as a series of function compositions like actions. 

&gt; Foo Foo hops, then scoops, then bops. 

- read more at: https://r4ds.had.co.nz/pipes.html 

]

---

# Take 3 minutes to discuss these two concepts with your table

.vhuge[
- What are pipes
- What is assignment?
]



---
class: bg-main1

# The many shapes and sizes of data

---
class: bg-main1

# Data as an audio file


```
## # A tibble: 50,001 x 3
##        t  left right
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     1    28    29
##  2     2    27    28
##  3     3    26    24
##  4     4    24    27
##  5     5    22    18
##  6     6    15    19
##  7     7    15    13
##  8     8    12    13
##  9     9    15    16
## 10    10    18    16
## # … with 49,991 more rows
```


---
class: bg-main1

# Plotting audio data?

&lt;img src="lecture-5b-slides_files/figure-html/show-audio-1.png" width="90%" style="display: block; margin: auto;" /&gt;

---

# Compare left and right channels

&lt;img src="lecture-5b-slides_files/figure-html/gg-compare-left-and-right-1.png" width="90%" style="display: block; margin: auto;" /&gt;


???

Oh, same sound is on both channels! A tad drab.

---
class: bg-main1

# Compute statistics





```r
df_wavs %&gt;%
  filter(channel == "left") %&gt;%
  group_by(word) %&gt;%
  summarise(
    m = mean(value),
    s = sd(value),
    mx = max(value),
    mn = min(value)
  ) %&gt;%
  as_table()
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; word &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; m &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; s &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mx &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mn &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; data &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.004 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1602.577 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8393 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -15386 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; word &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.009 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1506.626 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6601 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -11026 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
class: bg-main1

# Di's music





```
##                             artist      type        lvar        lave  lmax    lfener
## Dancing Queen                 Abba      Rock  17600755.6 -90.0068667 29921 105.92095
## Knowing Me                    Abba      Rock   9543020.9 -75.7667187 27626 102.83616
## Take a Chance                 Abba      Rock   9049481.5 -98.0629244 26372 102.32488
## Mamma Mia                     Abba      Rock   7557437.3 -90.4710616 28898 101.61648
## Lay All You                   Abba      Rock   6282285.6 -88.9526309 27940 100.30076
## Super Trouper                 Abba      Rock   4665866.7 -69.0208450 25531 100.24848
## I Have A Dream                Abba      Rock   3369670.3 -71.6828788 14699 104.59686
## The Winner                    Abba      Rock   1135862.0 -67.8190467  8928 104.34921
## Money                         Abba      Rock   6146942.6 -76.2807500 22962 102.24066
## SOS                           Abba      Rock   3482881.8 -74.1300038 15517 104.36243
## V1                         Vivaldi Classical   3677296.2  66.6530970 24229  99.25243
## V2                         Vivaldi Classical    771491.8  21.6560941  6936 104.36737
## V3                         Vivaldi Classical   5227573.2  88.6465556 17721 104.61255
## V4                         Vivaldi Classical    334719.1  13.8318847  4123 104.35005
## V5                         Vivaldi Classical    836904.9  34.5677377 17306  88.82821
## V6                         Vivaldi Classical  13936436.7 216.2317586 30355 104.82354
## V7                         Vivaldi Classical   3636324.3   9.8366363 21450 100.52727
## V8                         Vivaldi Classical    295397.4   2.8143227  2985 108.28717
## V9                         Vivaldi Classical   4335879.0  10.9015767 22271 101.32881
## V10                        Vivaldi Classical    472630.0   3.8890862  8194  98.83731
## M1                          Mozart Classical   2819795.0  -5.8667602 14939 102.25358
## M2                          Mozart Classical   2836957.9  -5.6074580 13382 102.04646
## M3                          Mozart Classical   9089372.1  -5.9719205 25265 102.23796
## M4                          Mozart Classical   4056229.7  -6.2272904 21328  97.59887
## M5                          Mozart Classical   1568925.6  -6.1993790 15839  99.47580
## M6                          Mozart Classical   7758409.1  -5.7700183 22496 101.66942
## All in a Days Work            Eels      Rock  40275677.4 -10.6893416 32759 106.07617
## Saturday Morning              Eels      Rock 129472199.3  50.2115773 32759 114.00229
## The Good Old Days             Eels      Rock  18838849.0  -0.0222764 30386 105.45611
## Love of the Loveless          Eels      Rock  43201194.3   1.8926897 32759 108.37835
## Girl                          Eels      Rock  88547131.0   0.3358761 32744 112.00916
## Agony                         Eels      Rock  16285811.4  -0.1405876 30106 103.94171
## Rock Hard Times               Eels      Rock  54651552.8   1.9848514 32759 108.87503
## Restraining                   Eels      Rock  12322434.4   1.0259790 23221 103.29906
## Lone Wolf                     Eels      Rock  63878899.8   3.3592505 32759 109.53291
## Wrong About Bobby             Eels      Rock  43668186.9  -2.0125667 32759 108.35559
## Love Me Do                 Beatles      Rock  28806811.2  -5.7452189 24159 109.95808
## I Want to Hold Your Hand   Beatles      Rock  61257693.6  -6.0340682 28502 111.81813
## Cant Buy Me Love           Beatles      Rock  76729438.0  -5.9583971 30102 112.71792
## I Feel Fine                Beatles      Rock  52497242.7  -5.7314591 29911 110.66333
## Ticket to Ride             Beatles      Rock  68104547.0  -6.1449114 30415 111.59957
## Help                       Beatles      Rock  52569372.5  -5.7166301 32318 110.34618
## Yesterday                  Beatles      Rock  23080907.6  -6.0298337 28169 107.30541
## Yellow Submarine           Beatles      Rock  39908667.5  -6.2616915 29061 109.47442
## Eleanor Rigby              Beatles      Rock  18819753.2  -6.1265193 21680 108.65894
## Penny Lane                 Beatles      Rock  58614798.7  -5.9971242 31131 111.18901
## B1                       Beethoven Classical   8368952.9  -0.9538330 26645 101.74095
## B2                       Beethoven Classical    293608.3  -0.1247094  4554 103.26160
## B3                       Beethoven Classical   8051764.6  -0.3316964 24194 101.20132
## B4                       Beethoven Classical  23493873.6  -0.9411538 32766 106.18220
## B5                       Beethoven Classical   1640232.8   1.3899979 20877  94.59029
## B6                       Beethoven Classical    343973.1  -2.4748955  9225  93.38874
## B7                       Beethoven Classical   3644784.2  -1.0426907 24633  97.86394
## B8                       Beethoven Classical  15030950.3  -1.4394652 26066 106.39731
## The Memory of Trees           Enya  New wave   1135493.1 -10.6183398  9994 102.16132
## Anywhere Is                   Enya  New wave  12230252.2 -17.8372700 24968 105.75748
## Pax Deorum                    Enya  New wave   1723627.9  -6.8327065 13227 101.86845
## Waterloo                      Abba      Rock  24898675.9 -93.9961871 29830 107.73299
## V11                        Vivaldi Classical   1879989.2  12.7213373  8601 105.81750
## V12                        Vivaldi Classical    737349.6   5.7190022  7089 102.92123
## V13                        Vivaldi Classical   2865979.9  21.4467629 17282 102.11314
## Hey Jude                   Beatles      Rock   8651854.1  -6.1322408 18509  83.88195
##                              lfreq
## Dancing Queen             59.57379
## Knowing Me                58.48031
## Take a Chance            124.59397
## Mamma Mia                 48.76513
## Lay All You               74.02039
## Super Trouper             81.40140
## I Have A Dream           305.18689
## The Winner               277.66056
## Money                    165.15799
## SOS                      146.73700
## V1                       329.53792
## V2                       843.83240
## V3                       165.76781
## V4                       293.99972
## V5                       198.38305
## V6                       198.46716
## V7                       877.77243
## V8                        58.41722
## V9                       176.53441
## V10                      526.04942
## M1                       342.26017
## M2                       511.85517
## M3                       429.27618
## M4                       343.75319
## M5                       288.44819
## M6                       459.24182
## All in a Days Work        65.48281
## Saturday Morning          41.40515
## The Good Old Days        165.24210
## Love of the Loveless     174.64185
## Girl                     392.28702
## Agony                    312.06322
## Rock Hard Times          312.37864
## Restraining              185.59771
## Lone Wolf                 66.13469
## Wrong About Bobby         98.83404
## Love Me Do               126.50757
## I Want to Hold Your Hand 294.67263
## Cant Buy Me Love         100.20089
## I Feel Fine              110.39972
## Ticket to Ride           107.30853
## Help                     137.10594
## Yesterday                173.50631
## Yellow Submarine          91.49508
## Eleanor Rigby            164.92667
## Penny Lane                92.46240
## B1                       354.12025
## B2                       316.03761
## B3                       397.18666
## B4                       529.26679
## B5                       445.00551
## B6                       331.68283
## B7                       181.01349
## B8                       249.08280
## The Memory of Trees      155.06430
## Anywhere Is               79.31957
## Pax Deorum                49.01748
## Waterloo                 146.04306
## V11                       58.83780
## V12                      175.94562
## V13                       61.44533
## Hey Jude                 219.53773
```

---
class: bg-main1

# Plot Di's music

&lt;img src="lecture-5b-slides_files/figure-html/gg-di-music-1.png" width="90%" style="display: block; margin: auto;" /&gt;

---
class: bg-main1

# Plot Di's Music

&lt;img src="lecture-5b-slides_files/figure-html/gg-di-music-points-1.png" width="90%" style="display: block; margin: auto;" /&gt;

Abba is just different from everyone else!

---
class: bg-main1

# Question time:

.huge[
-   "How does `data` appear different than `statistics` in the time series?"
-   "What format is the data in an audio file?"
-   "How is Abba different from the other music clips?",
]

<div class="countdown" id="timer_5d67f830" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">01</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">30</span></code>
</div>



---
class: bg-main1

# Why look at audio data?

.huge[
- Data comes in many shapes and sizes
- A lot of data is available in html tables on web sites. 
- Extracting the data from these tables is called "web scraping". 
]

---


# Scraping the web: what? why?

.huge[
- Increasing amount of data is available on the web.
- These data are provided in an unstructured format: you can always copy&amp;paste, but it's 
time-consuming and prone to errors.
- Web scraping is the process of extracting this information automatically and transform it into 
a structured dataset.
]

---

# Scraping the web: what? why?

.huge[
1. Screen scraping: extract data from source code of website, with html parser (easy) or regular expression matching (less easy).
2. Web APIs (application programming interface): website offers a set of structured http  requests that return JSON or XML files.
- Why R? It includes all tools necessary to do web scraping, familiarity, direct analysis of data... But python, perl, java are also efficient tools.
]

---
class: bg-main1
# Web Scraping with rvest

---
class: bg-main1
# Hypertext Markup Language

.huge[
Most of the data on the web is still largely available as HTML - while it is structured (hierarchical / tree based) it often is not available in a form useful for analysis (flat / tidy).
]

```html
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;This is a title&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p align="center"&gt;Hello world!&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
```

---
class: bg-main1

# rvest: Simplifies processing and manipulating HTML data

.huge[
- `read_html` - read HTML data from a url or character string.
- `html_nodes` - select specified nodes from the HTML document using CSS selectors.
- `html_table` - parse an HTML table into a data frame.
- `html_text` - extract tag pairs' content.
- `paths_allowed()` - from `robotstxt`, tells you if you can scrape something, legally.

]

---
class: bg-main1

# SelectorGadget: css selectors

.vlarge[
- Using a tool called selector gadget to **help** identify the html elements of interest
- Does this by constructing a css selector which can be used to subset the html document.

Selector          |  Example         |     Description
------------      |------------------|      ------------------------------------------------
element           |  `p`             |      Select all &amp;lt;p&amp;gt; elements
element element   |  `div p`         |      Select all &amp;lt;p&amp;gt; elements inside a &amp;lt;div&amp;gt; element          
element&gt;element   |  `div &gt; p`       |      Select all &amp;lt;p&amp;gt; elements with &amp;lt;div&amp;gt; as a parent
.class            |  `.title`        |      Select all elements with class="title"
\#id              |  `.name`         |      Select all elements with id="name"
[attribute]       |  `[class]`       |      Select all elements with a class attribute
[attribute=value] |  `[class=title]` |      Select all elements with class="title"
]
---
class: bg-main1

# SelectorGadget

.vlarge[
- SelectorGadget: Open source tool that eases CSS selector generation and discovery
- Install the [Chrome Extension](https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb) 
- A box will open in the bottom right of the website. Click on a page element 
that you would like your selector to match (it will turn green). SelectorGadget 
will then generate a minimal CSS selector for that element, and will highlight 
(yellow) everything that is 
matched by the selector. 
- Now click on a highlighted element to remove it from the selector (red), or 
click on an unhighlighted element to add it to the selector. Through this process 
of selection and rejection, SelectorGadget helps you come up with the appropriate 
CSS selector for your needs.
]
---
class: bg-main1

## Top 250 movies on IMDB

.left-code[
Take a look at the source code, look for the tag `table` tag:
&lt;br&gt;
http://www.imdb.com/chart/top
]


.right-plot[
&lt;img src="images/imdb_top_250.png" width="90%" style="display: block; margin: auto;" /&gt;
]


---
class: bg-main1

## First check to make sure you're allowed!


```r
# install.packages("robotstxt")
library(robotstxt)
paths_allowed("http://www.imdb.com")
```

```
## [1] TRUE
```

.huge[
vs. e.g.
]

--


```r
paths_allowed("http://www.facebook.com")
```

```
## [1] FALSE
```

---
class: bg-main1

# Join in

.vhuge[
Go to [rstudio.cloud](https://rstudio.cloud/) `\(\rightarrow\)` Lecture 5B `\(\rightarrow\)` Make a copy `\(\rightarrow\)` `lecture-5B.Rmd`
]

---
class: bg-main1

## Select and format pieces: titles


```r
library(rvest)

page &lt;- read_html("http://www.imdb.com/chart/top")

titles &lt;- page %&gt;%
  html_nodes(".titleColumn a") %&gt;%
  html_text()

titles
```

```
##   [1] "The Shawshank Redemption"                                            
##   [2] "The Godfather"                                                       
##   [3] "The Godfather: Part II"                                              
##   [4] "The Dark Knight"                                                     
##   [5] "12 Angry Men"                                                        
##   [6] "Schindler's List"                                                    
##   [7] "The Lord of the Rings: The Return of the King"                       
##   [8] "Pulp Fiction"                                                        
##   [9] "The Good, the Bad and the Ugly"                                      
##  [10] "Fight Club"                                                          
##  [11] "The Lord of the Rings: The Fellowship of the Ring"                   
##  [12] "Forrest Gump"                                                        
##  [13] "Inception"                                                           
##  [14] "Star Wars: Episode V - The Empire Strikes Back"                      
##  [15] "The Lord of the Rings: The Two Towers"                               
##  [16] "The Matrix"                                                          
##  [17] "One Flew Over the Cuckoo's Nest"                                     
##  [18] "Goodfellas"                                                          
##  [19] "Seven Samurai"                                                       
##  [20] "Se7en"                                                               
##  [21] "Cidade de Deus"                                                      
##  [22] "Life Is Beautiful"                                                   
##  [23] "The Silence of the Lambs"                                            
##  [24] "Star Wars"                                                           
##  [25] "It's a Wonderful Life"                                               
##  [26] "Saving Private Ryan"                                                 
##  [27] "Spirited Away"                                                       
##  [28] "The Green Mile"                                                      
##  [29] "Léon: The Professional"                                              
##  [30] "Interstellar"                                                        
##  [31] "The Usual Suspects"                                                  
##  [32] "Avengers: Endgame"                                                   
##  [33] "American History X"                                                  
##  [34] "The Lion King"                                                       
##  [35] "Back to the Future"                                                  
##  [36] "Modern Times"                                                        
##  [37] "The Pianist"                                                         
##  [38] "Terminator 2: Judgment Day"                                          
##  [39] "The Intouchables"                                                    
##  [40] "Psycho"                                                              
##  [41] "Gladiator"                                                           
##  [42] "City Lights"                                                         
##  [43] "The Departed"                                                        
##  [44] "Whiplash"                                                            
##  [45] "Once Upon a Time in the West"                                        
##  [46] "The Prestige"                                                        
##  [47] "Casablanca"                                                          
##  [48] "Grave of the Fireflies"                                              
##  [49] "Rear Window"                                                         
##  [50] "Cinema Paradiso"                                                     
##  [51] "Raiders of the Lost Ark"                                             
##  [52] "Alien"                                                               
##  [53] "Memento"                                                             
##  [54] "Apocalypse Now"                                                      
##  [55] "The Great Dictator"                                                  
##  [56] "The Lives of Others"                                                 
##  [57] "Avengers: Infinity War"                                              
##  [58] "Spider-Man: Into the Spider-Verse"                                   
##  [59] "Django Unchained"                                                    
##  [60] "The Shining"                                                         
##  [61] "Paths of Glory"                                                      
##  [62] "WALL·E"                                                              
##  [63] "Sunset Blvd."                                                        
##  [64] "Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb"
##  [65] "Princess Mononoke"                                                   
##  [66] "Oldeuboi"                                                            
##  [67] "Witness for the Prosecution"                                         
##  [68] "The Dark Knight Rises"                                               
##  [69] "Once Upon a Time in America"                                         
##  [70] "Aliens"                                                              
##  [71] "Coco"                                                                
##  [72] "American Beauty"                                                     
##  [73] "Kimi no na wa."                                                      
##  [74] "Braveheart"                                                          
##  [75] "Das Boot"                                                            
##  [76] "3 Idiots"                                                            
##  [77] "Taare Zameen Par"                                                    
##  [78] "Star Wars: Episode VI - Return of the Jedi"                          
##  [79] "Reservoir Dogs"                                                      
##  [80] "Toy Story"                                                           
##  [81] "Amadeus"                                                             
##  [82] "Dangal"                                                              
##  [83] "M - Eine Stadt sucht einen Mörder"                                   
##  [84] "Requiem for a Dream"                                                 
##  [85] "Good Will Hunting"                                                   
##  [86] "Vertigo"                                                             
##  [87] "Inglourious Basterds"                                                
##  [88] "2001: A Space Odyssey"                                               
##  [89] "Eternal Sunshine of the Spotless Mind"                               
##  [90] "Citizen Kane"                                                        
##  [91] "Full Metal Jacket"                                                   
##  [92] "Jagten"                                                              
##  [93] "North by Northwest"                                                  
##  [94] "A Clockwork Orange"                                                  
##  [95] "Snatch"                                                              
##  [96] "Amelie"                                                              
##  [97] "The Kid"                                                             
##  [98] "Bicycle Thieves"                                                     
##  [99] "Scarface"                                                            
## [100] "Singin' in the Rain"                                                 
## [101] "Lawrence of Arabia"                                                  
## [102] "Toy Story 3"                                                         
## [103] "The Sting"                                                           
## [104] "Taxi Driver"                                                         
## [105] "Per qualche dollaro in più"                                          
## [106] "Metropolis"                                                          
## [107] "Double Indemnity"                                                    
## [108] "Jodaeiye Nader az Simin"                                             
## [109] "To Kill a Mockingbird"                                               
## [110] "Ikiru"                                                               
## [111] "Indiana Jones and the Last Crusade"                                  
## [112] "The Apartment"                                                       
## [113] "Up"                                                                  
## [114] "L.A. Confidential"                                                   
## [115] "Monty Python and the Holy Grail"                                     
## [116] "Incendies"                                                           
## [117] "Heat"                                                                
## [118] "Rashomon"                                                            
## [119] "Yojimbo"                                                             
## [120] "Batman Begins"                                                       
## [121] "Die Hard"                                                            
## [122] "Green Book"                                                          
## [123] "Unforgiven"                                                          
## [124] "Downfall"                                                            
## [125] "Bacheha-Ye aseman"                                                   
## [126] "Some Like It Hot"                                                    
## [127] "Howl's Moving Castle"                                                
## [128] "The Great Escape"                                                    
## [129] "My Neighbor Totoro"                                                  
## [130] "All About Eve"                                                       
## [131] "Ran"                                                                 
## [132] "A Beautiful Mind"                                                    
## [133] "Pan's Labyrinth"                                                     
## [134] "Casino"                                                              
## [135] "El secreto de sus ojos"                                              
## [136] "Raging Bull"                                                         
## [137] "Idi i smotri"                                                        
## [138] "Lock, Stock and Two Smoking Barrels"                                 
## [139] "Babam ve Oglum"                                                      
## [140] "The Treasure of the Sierra Madre"                                    
## [141] "The Wolf of Wall Street"                                             
## [142] "Judgment at Nuremberg"                                               
## [143] "Three Billboards Outside Ebbing, Missouri"                           
## [144] "Chinatown"                                                           
## [145] "The Gold Rush"                                                       
## [146] "Inside Out"                                                          
## [147] "Dial M for Murder"                                                   
## [148] "V for Vendetta"                                                      
## [149] "Det sjunde inseglet"                                                 
## [150] "Warrior"                                                             
## [151] "There Will Be Blood"                                                 
## [152] "Room"                                                                
## [153] "Trainspotting"                                                       
## [154] "Andhadhun"                                                           
## [155] "No Country for Old Men"                                              
## [156] "The Elephant Man"                                                    
## [157] "The Sixth Sense"                                                     
## [158] "Shutter Island"                                                      
## [159] "The Thing"                                                           
## [160] "Eskiya"                                                              
## [161] "The Bridge on the River Kwai"                                        
## [162] "Gone with the Wind"                                                  
## [163] "The Third Man"                                                       
## [164] "On the Waterfront"                                                   
## [165] "Blade Runner"                                                        
## [166] "Smultronstället"                                                     
## [167] "Finding Nemo"                                                        
## [168] "Jurassic Park"                                                       
## [169] "Gran Torino"                                                         
## [170] "Fargo"                                                               
## [171] "Kill Bill: Vol. 1"                                                   
## [172] "The Deer Hunter"                                                     
## [173] "Tôkyô monogatari"                                                    
## [174] "The Big Lebowski"                                                    
## [175] "Stalker"                                                             
## [176] "The Truman Show"                                                     
## [177] "Relatos salvajes"                                                    
## [178] "Mary and Max"                                                        
## [179] "Hacksaw Ridge"                                                       
## [180] "Gone Girl"                                                           
## [181] "In the Name of the Father"                                           
## [182] "Sherlock Jr."                                                        
## [183] "The General"                                                         
## [184] "How to Train Your Dragon"                                            
## [185] "Mr. Smith Goes to Washington"                                        
## [186] "The Grand Budapest Hotel"                                            
## [187] "Salinui chueok"                                                      
## [188] "Persona"                                                             
## [189] "Before Sunrise"                                                      
## [190] "Toy Story 4"                                                         
## [191] "Catch Me If You Can"                                                 
## [192] "Into the Wild"                                                       
## [193] "Cool Hand Luke"                                                      
## [194] "Le salaire de la peur"                                               
## [195] "12 Years a Slave"                                                    
## [196] "Network"                                                             
## [197] "Andrei Rublev"                                                       
## [198] "Life of Brian"                                                       
## [199] "Rang De Basanti"                                                     
## [200] "La passion de Jeanne d'Arc"                                          
## [201] "Prisoners"                                                           
## [202] "Stand by Me"                                                         
## [203] "Mad Max: Fury Road"                                                  
## [204] "Platoon"                                                             
## [205] "Rush"                                                                
## [206] "Million Dollar Baby"                                                 
## [207] "Hachi: A Dog's Tale"                                                 
## [208] "Logan"                                                               
## [209] "Ben-Hur"                                                             
## [210] "Barry Lyndon"                                                        
## [211] "Hotel Rwanda"                                                        
## [212] "Amores perros"                                                       
## [213] "Kaze no tani no Naushika"                                            
## [214] "Spotlight"                                                           
## [215] "Harry Potter and the Deathly Hallows: Part 2"                        
## [216] "Les quatre cents coups"                                              
## [217] "Dead Poets Society"                                                  
## [218] "Rebecca"                                                             
## [219] "Rocky"                                                               
## [220] "Gangs of Wasseypur"                                                  
## [221] "Monsters, Inc."                                                      
## [222] "Lagaan: Once Upon a Time in India"                                   
## [223] "It Happened One Night"                                               
## [224] "El ángel exterminador"                                               
## [225] "Once Upon a Time in Hollywood"                                       
## [226] "La haine"                                                            
## [227] "Munna Bhai M.B.B.S."                                                 
## [228] "Ah-ga-ssi"                                                           
## [229] "The Princess Bride"                                                  
## [230] "Swades: We, the People"                                              
## [231] "PK"                                                                  
## [232] "Butch Cassidy and the Sundance Kid"                                  
## [233] "The Help"                                                            
## [234] "Drishyam"                                                            
## [235] "Before Sunset"                                                       
## [236] "A Wednesday"                                                         
## [237] "Paris, Texas"                                                        
## [238] "The Terminator"                                                      
## [239] "Akira"                                                               
## [240] "Sholay"                                                              
## [241] "Faa yeung nin wa"                                                    
## [242] "La battaglia di Algeri"                                              
## [243] "The End of Evangelion"                                               
## [244] "Mou gaan dou"                                                        
## [245] "Guardians of the Galaxy"                                             
## [246] "La leggenda del pianista sull'oceano"                                
## [247] "Kis Uykusu"                                                          
## [248] "Aladdin"                                                             
## [249] "Das Cabinet des Dr. Caligari"                                        
## [250] "Chak De! India"
```


---
class: bg-main1

# Select and format pieces: years


```r
years &lt;- page %&gt;%
  html_nodes(".secondaryInfo") %&gt;%
  html_text() %&gt;%
  str_replace("\\(", "") %&gt;% # remove (
  str_replace("\\)", "") %&gt;% # remove )
  as.numeric()

years
```

```
##   [1] 1994 1972 1974 2008 1957 1993 2003 1994 1966 1999 2001 1994 2010 1980 2002 1999 1975
##  [18] 1990 1954 1995 2002 1997 1991 1977 1946 1998 2001 1999 1994 2014 1995 2019 1998 1994
##  [35] 1985 1936 2002 1991 2011 1960 2000 1931 2006 2014 1968 2006 1942 1988 1954 1988 1981
##  [52] 1979 2000 1979 1940 2006 2018 2018 2012 1980 1957 2008 1950 1964 1997 2003 1957 2012
##  [69] 1984 1986 2017 1999 2016 1995 1981 2009 2007 1983 1992 1995 1984 2016 1931 2000 1997
##  [86] 1958 2009 1968 2004 1941 1987 2012 1959 1971 2000 2001 1921 1948 1983 1952 1962 2010
## [103] 1973 1976 1965 1927 1944 2011 1962 1952 1989 1960 2009 1997 1975 2010 1995 1950 1961
## [120] 2005 1988 2018 1992 2004 1997 1959 2004 1963 1988 1950 1985 2001 2006 1995 2009 1980
## [137] 1985 1998 2005 1948 2013 1961 2017 1974 1925 2015 1954 2005 1957 2011 2007 2015 1996
## [154] 2018 2007 1980 1999 2010 1982 1996 1957 1939 1949 1954 1982 1957 2003 1993 2008 1996
## [171] 2003 1978 1953 1998 1979 1998 2014 2009 2016 2014 1993 1924 1926 2010 1939 2014 2003
## [188] 1966 1995 2019 2002 2007 1967 1953 2013 1976 1966 1979 2006 1928 2013 1986 2015 1986
## [205] 2013 2004 2009 2017 1959 1975 2004 2000 1984 2015 2011 1959 1989 1940 1976 2012 2001
## [222] 2001 1934 1962 2019 1995 2003 2016 1987 2004 2014 1969 2011 2015 2004 2008 1984 1984
## [239] 1988 1975 2000 1966 1997 2002 2014 1998 2014 1992 1920 2007
```

---
class: bg-main1

# Select and format pieces: scores



```r
scores &lt;- page %&gt;%
  html_nodes("#main strong") %&gt;%
  html_text() %&gt;%
  as.numeric()
  
scores
```

```
##   [1] 9.2 9.1 9.0 9.0 8.9 8.9 8.9 8.9 8.8 8.8 8.8 8.8 8.7 8.7 8.7 8.6 8.6 8.6 8.6 8.6 8.6
##  [22] 8.6 8.6 8.6 8.6 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5
##  [43] 8.5 8.5 8.5 8.5 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4
##  [64] 8.4 8.4 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3
##  [85] 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2
## [106] 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2
## [127] 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1
## [148] 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1
## [169] 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1
## [190] 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.0 8.0
## [211] 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0
## [232] 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0 8.0
```

---
class: bg-main1

# Select and format pieces: put it all together


```r
imdb_top_250 &lt;- tibble(title = titles, 
                       year = years, 
                       score = scores)

imdb_top_250
```

```
## # A tibble: 250 x 3
##    title                                          year score
##    &lt;chr&gt;                                         &lt;dbl&gt; &lt;dbl&gt;
##  1 The Shawshank Redemption                       1994   9.2
##  2 The Godfather                                  1972   9.1
##  3 The Godfather: Part II                         1974   9  
##  4 The Dark Knight                                2008   9  
##  5 12 Angry Men                                   1957   8.9
##  6 Schindler's List                               1993   8.9
##  7 The Lord of the Rings: The Return of the King  2003   8.9
##  8 Pulp Fiction                                   1994   8.9
##  9 The Good, the Bad and the Ugly                 1966   8.8
## 10 Fight Club                                     1999   8.8
## # … with 240 more rows
```
]

---

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; title &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; score &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Shawshank Redemption &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1994 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9.2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Godfather &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9.1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Godfather: Part II &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1974 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Dark Knight &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2008 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 12 Angry Men &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Schindler's List &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1993 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Lord of the Rings: The Return of the King &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2003 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Pulp Fiction &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1994 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Good, the Bad and the Ugly &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1966 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Fight Club &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1999 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Lord of the Rings: The Fellowship of the Ring &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2001 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Forrest Gump &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1994 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Inception &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Star Wars: Episode V - The Empire Strikes Back &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1980 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Lord of the Rings: The Two Towers &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2002 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
class: bg-main1

# Clean up / enhance

.huge[
May or may not be a lot of work depending on how messy the data are

- See if you like what you got:
]


```r
glimpse(imdb_top_250)
```

```
## Observations: 250
## Variables: 3
## $ title &lt;chr&gt; "The Shawshank Redemption", "The Godfather", "The Godfather: Part II", "T…
## $ year  &lt;dbl&gt; 1994, 1972, 1974, 2008, 1957, 1993, 2003, 1994, 1966, 1999, 2001, 1994, 2…
## $ score &lt;dbl&gt; 9.2, 9.1, 9.0, 9.0, 8.9, 8.9, 8.9, 8.9, 8.8, 8.8, 8.8, 8.8, 8.7, 8.7, 8.7…
```

---
class: bg-main1

# Clean up / enhance

.huge[
- Add a variable for rank
]


```r
imdb_top_250 %&gt;%
  mutate(
    rank = 1:nrow(imdb_top_250)
  )
```

```
## # A tibble: 250 x 4
##    title                                          year score  rank
##    &lt;chr&gt;                                         &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
##  1 The Shawshank Redemption                       1994   9.2     1
##  2 The Godfather                                  1972   9.1     2
##  3 The Godfather: Part II                         1974   9       3
##  4 The Dark Knight                                2008   9       4
##  5 12 Angry Men                                   1957   8.9     5
##  6 Schindler's List                               1993   8.9     6
##  7 The Lord of the Rings: The Return of the King  2003   8.9     7
##  8 Pulp Fiction                                   1994   8.9     8
##  9 The Good, the Bad and the Ugly                 1966   8.8     9
## 10 Fight Club                                     1999   8.8    10
## # … with 240 more rows
```

---

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; title &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; score &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; rank &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Shawshank Redemption &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1994 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Godfather &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9.1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Godfather: Part II &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1974 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Dark Knight &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2008 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 12 Angry Men &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Schindler's List &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1993 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Lord of the Rings: The Return of the King &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2003 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Pulp Fiction &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1994 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Good, the Bad and the Ugly &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1966 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Fight Club &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1999 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Lord of the Rings: The Fellowship of the Ring &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2001 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 11 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Forrest Gump &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1994 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 12 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Inception &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.7 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 13 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Star Wars: Episode V - The Empire Strikes Back &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1980 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.7 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 14 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; The Lord of the Rings: The Two Towers &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2002 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.7 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
class: bg-main5

# Your Turn

.huge[
How would you go about answering this question: Which 1995 movies made the list?
]

---
class: bg-main1


```r
imdb_top_250 %&gt;% 
  filter(year == 1995)
```

```
## # A tibble: 8 x 3
##   title               year score
##   &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;
## 1 Se7en               1995   8.6
## 2 The Usual Suspects  1995   8.5
## 3 Braveheart          1995   8.3
## 4 Toy Story           1995   8.3
## 5 Heat                1995   8.2
## 6 Casino              1995   8.2
## 7 Before Sunrise      1995   8.1
## 8 La haine            1995   8
```

---
class: bg-main1

# Your turn

.huge[
How would you go about answering this question: Which years have the most movies on the list?
]

--


```r
imdb_top_250 %&gt;% 
  group_by(year) %&gt;%
  summarise(total = n()) %&gt;%
  arrange(desc(total)) %&gt;%
  head(5)
```

```
## # A tibble: 5 x 2
##    year total
##   &lt;dbl&gt; &lt;int&gt;
## 1  1995     8
## 2  2014     8
## 3  2004     7
## 4  1957     6
## 5  1997     6
```

---
class: bg-main1

# Your Turn

.huge[

How would you go about creating this visualization: Visualize the average yearly score for movies that made it on the top 250 list over time.
]

--


```r
imdb_top_250 %&gt;% 
  group_by(year) %&gt;%
  summarise(avg_score = mean(score)) %&gt;%
  ggplot(aes(y = avg_score, x = year)) +
    geom_point() +
    geom_smooth(method = "lm") +
    xlab("year")
```

---
class: bg-main1



```r
imdb_top_250 %&gt;% 
  group_by(year) %&gt;%
  summarise(avg_score = mean(score)) %&gt;%
  ggplot(aes(y = avg_score, x = year)) +
    geom_point() +
    geom_smooth(method = "lm") +
    xlab("year")
```

&lt;img src="lecture-5b-slides_files/figure-html/visualise-score-year-print-1.png" width="90%" style="display: block; margin: auto;" /&gt;

---

# Briefly - other formats - JSON

---
class: bg-main1

# JSON format files

.huge[
- JavaScript Object Notation (JSON). 
- A language-independent data format, and supplants extensible markup language (XML). 
- Example JSON from [jsonlite](https://cran.r-project.org/web/packages/jsonlite/vignettes/json-aaquickstart.html) describing Mario, Peach, and Bowser:
]


```r
library(jsonlite)
json_mario &lt;-
'[
  {"Name" : "Mario", "Age" : 32, "Occupation" : "Plumber"}, 
  {"Name" : "Peach", "Age" : 21, "Occupation" : "Princess"},
  {},
  {"Name" : "Bowser", "Occupation" : "Koopa"}
]'
mydf &lt;- fromJSON(json_mario)
mydf
```

```
##     Name Age Occupation
## 1  Mario  32    Plumber
## 2  Peach  21   Princess
## 3   &lt;NA&gt;  NA       &lt;NA&gt;
## 4 Bowser  NA      Koopa
```

---

# Potential challenges with web scraping

.huge[
- Unreliable formatting at the source
- Data broken into many pages
- Data arriving in multiple excel file formats
- ...


&gt; Compare the display of information at [gumtree melbourne](https://www.gumtree.com.au/s-monash/l3001600) to the list on the IMDB top 250 list. What challenges can you foresee in scraping a list of the available apartments?
]


---

# Further exploring

People write R packages to access online data! Check out:

.huge[
- [cricinfo by Sayani Gupta and Rob Hyndman]()
- [rwalkr by Earo Wang]()
- [fitzRoy by ]()
- [Top 40 lists of R packages by Joe Rickert](https://rviews.rstudio.com/2019/07/24/june-2019-top-40-r-packages/) - they usually include a "data" section.
]

---

# Share and share alike

&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;&lt;img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /&gt;&lt;/a&gt;&lt;br /&gt;This work is licensed under a &lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;Creative Commons Attribution 4.0 International License&lt;/a&gt;.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
